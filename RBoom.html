<!DOCTYPE html>
<html>
<head>
  <title>Rust Resource Challenge</title>
  <style>
  body { background:#2e2b22; color:#cfc9b8; font-family: monospace; text-align:center; }
  #resources {
    margin: 20px auto;
    width: 700px;
    height: 200px;
    position: relative;
    border: 2px solid #a37453;
    border-radius: 10px;
    background-color: #403729;
    user-select: none;
    overflow: hidden;
  }
  .resource {
    position: absolute;
    width: 100px; height: 100px;
    background-color: #604830;
    border: 3px solid #a37453;
    line-height: 100px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 8px;
    box-shadow: 0 0 10px #b28658;
    transition: opacity 0.3s ease;
    color: #cfc9b8;
  }
  .trap {
    background-color: #7a2222 !important;
    border-color: #a55353 !important;
    color: #f0b0b0 !important;
  }
  #scoreboard, #timer, #message {
    margin-top: 20px;
    font-size: 24px;
    min-height: 1.5em;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    background-color: #b36b00;
    border: none;
    border-radius: 5px;
    color: white;
    user-select: none;
  }
</style>

</head>
<body>

<h1>Rust Resource Challenge</h1>
<p>Gather resources and avoid hazards to reach the target score before time runs out!</p>

<div id="resources"></div>

<div id="scoreboard">Score: 0</div>
<div id="timer">Time left: 20</div>
<div id="message"></div>
<button id="startBtn">Start Challenge</button>

<script>
 const t=[{id:"wood",text:"Wood",points:2},{id:"stone",text:"Stone",points:4},{id:"scrap",text:"Scrap",points:5},{id:"metal",text:"Metal",points:7}],e={id:"trap",text:"Radiation",points:-7},n=document.getElementById("resources"),o=document.getElementById("scoreboard"),a=document.getElementById("timer"),l=document.getElementById("message"),i=document.getElementById("startBtn"),s=function(){const t={};return window.location.search.substring(1).split("&").forEach(e=>{const[n,o]=e.split("=");n&&(t[n]=decodeURIComponent(o))}),t}(),r=parseInt(s.time)||20,d=parseInt(s.target)||30,c="1"===s.trap,p=s.code||"RUST-0000";let m=0,u=r,g=null,h=null,x=!1;const y="rust_challenge_played_"+p;function I(){o.textContent="Score: 0",a.textContent="Time left: "+r,l.textContent=""}function f(){if(!x)return;let a=t.slice();c&&a.push(e);const l=a[Math.floor(Math.random()*a.length)],i=document.createElement("div");i.classList.add("resource"),"trap"===l.id&&i.classList.add("trap"),i.textContent=l.text,i.dataset.points=l.points;n.getBoundingClientRect();const s=n.clientWidth-100-10,r=n.clientHeight-100-10,p=Math.floor(Math.random()*s)+10,u=Math.floor(Math.random()*r)+10;i.style.left=p+"px",i.style.top=u+"px",i.addEventListener("click",()=>{if(!x)return;!function(t){m+=t,m<0&&(m=0);o.textContent="Score: "+m,m>=d&&C(!0)}(parseInt(i.dataset.points)),i.style.transition="opacity 0.3s ease",i.style.opacity=0,setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},300)}),n.appendChild(i)}function C(t){x=!1,clearInterval(g),clearInterval(h),n.innerHTML="",t?(l.innerHTML="Challenge complete! Your code:<br><strong>"+p+"</strong>",localStorage.setItem(y,"true")):l.textContent="Time's up! Better luck next time.",i.disabled=!1}localStorage.getItem(y)&&(i.disabled=!0,l.textContent="You have already played this challenge."),I(),i.addEventListener("click",function(){localStorage.getItem(y)?l.textContent="You have already played this challenge.":(m=0,u=r,I(),x=!0,i.disabled=!0,g=setInterval(()=>{u--,a.textContent="Time left: "+u,u<=0&&C(!1)},1e3),h=setInterval(()=>{f()},500))});
</script>

</body>
</html>
